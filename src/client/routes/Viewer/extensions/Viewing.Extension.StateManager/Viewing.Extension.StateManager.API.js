////////////////////////////////////////////////////////////////
// StateManager API
//
/////////////////////////////////////////////////////////////////
export default class StatesAPI {

  ///////////////////////////////////////////////////////////////
  // Class constructor
  //
  ///////////////////////////////////////////////////////////////
  constructor(apiUrl) {

    this._apiUrl = apiUrl;
  }

  ///////////////////////////////////////////////////////////////
  //
  //
  ///////////////////////////////////////////////////////////////
  async getSequence(modelId) {

  var url = this._apiUrl +
    `/models/${modelId}/states/sequence`;

  var res = await fetch(url);

  return res.json();
}

  ///////////////////////////////////////////////////////////////
  //
  //
  ///////////////////////////////////////////////////////////////
  async getStates(modelId) {

  var url = this._apiUrl +
    `/models/${modelId}/states`;

  var res = await fetch(url);

  return res.json();
}

  ///////////////////////////////////////////////////////////////
  //
  //
  ///////////////////////////////////////////////////////////////
  async post(url, payload) {

  var res = await fetch(url, {
    method: 'post',
    headers: {
      'Accept': 'application/json',
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(payload || {})
  });

  return res.json();
}

  ///////////////////////////////////////////////////////////////
  //
  //
  ///////////////////////////////////////////////////////////////
  async saveSequence(modelId, sequence) {

  var payload = {
    sequence: sequence
  }

  var url = this._apiUrl +
    `/models/${modelId}/states/sequence`;

  return this.post(url, payload);
}

  ///////////////////////////////////////////////////////////////
  //
  //
  ///////////////////////////////////////////////////////////////
  async addState(modelId, state) {

  var payload = {
    state: state
  }

  var url = this._apiUrl +
    `/models/${modelId}/states`;

  return this.post(url, payload);
}

  ///////////////////////////////////////////////////////////////
  //
  //
  ///////////////////////////////////////////////////////////////
  removeState(modelId, stateId) {

    var url = this._apiUrl +
      `/models/${modelId}/states/${stateId}/remove`;

    return this.post(url);
  }
}